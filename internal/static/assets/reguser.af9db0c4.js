import{a as C,r as i,ag as c,c as F,e as d,t as m,g as r,h as u,I as R,u as I,b as P,x as _,j as D,_ as K}from"./index.8b9ac424.js";import{E as U}from"./el-link.71d4b09d.js";import{E as q,a as B}from"./el-form-item.c6e8a706.js";import{E as M}from"./el-input.27869b63.js";import{u as N,o as S,p as j,j as L,k as T}from"./index.44c9dfc9.js";import"./size.4b7247cf.js";import"./index.c82c4d11.js";import"./_baseClone.fc179f2b.js";import"./_Uint8Array.c4f2c30d.js";const z={class:"login"},A={class:"login-form"},G=["disabled"],H=C({__name:"reguser",setup(J){const a=i(),p=i(),h=i("left"),b=N(),v=i(""),f=i(!1),t=c({email:"",newpassword:"",check:""}),w=i(),k=(o,e,l)=>{if(e==="")return l(new Error("Please input the email"));if(!S.test(t.email))l(new Error("wrong email format"));else{if(!p.value)return;p.value.validateField("email",()=>null),l()}},$=c({newpassword:[{required:!0,validator:async(o,e,l)=>{if(e==="")l(new Error("Please input the password"));else{if(j.test(t.newpassword))l(new Error("no \u4E2D\u6587 in password"));else if(!L.test(t.newpassword))l(new Error("password must contain letters, numbers, length > 8"));else if(t.newpassword.length>7){if(!a.value)return;a.value.validateField("newpassword",()=>null)}else l(new Error("Please input the password's length >= 8"));l()}},trigger:"blur"}],check:[{required:!0,message:"please input code",rigger:"blur"}]}),V=c({email:[{required:!0,validator:k,trigger:"blur"}]});function E(o){if(!f.value){f.value=!0;let e=60,l=setInterval(()=>{e--,v.value=`${e}s `},1e3);setTimeout(()=>{f.value=!1,v.value="",clearInterval(l)},e*1e3),T({email:t.email}).then(n=>{w.value=n.code},n=>{console.log("err",n.message)})}}function g(o){!o||o.validate(e=>{if(e)w.value!=null&&b.reguser({...t,code:w.value});else return!1})}return(o,e)=>{const l=M,n=q,y=B,x=U;return P(),F("div",z,[d("h3",null,"your nodes "+m(o.$t("reguser")),1),d("div",A,[r(y,{"label-position":h.value,"label-width":"100px",rules:V,model:t,style:{"max-width":"460px"},ref_key:"ruleFormRef",ref:a},{default:u(()=>[r(n,{label:o.$t("email"),prop:"email"},{default:u(()=>[r(l,{modelValue:t.email,"onUpdate:modelValue":e[0]||(e[0]=s=>t.email=s),modelModifiers:{trim:!0},placeholder:"email",maxlength:"60",onKeydown:e[1]||(e[1]=_(s=>E(p.value),["enter"]))},null,8,["modelValue"]),d("button",{onClick:e[2]||(e[2]=s=>E(p.value)),style:{float:"left"},disabled:f.value},m(v.value)+m(o.$t("getcode")),9,G)]),_:1},8,["label"])]),_:1},8,["label-position","rules","model"]),r(y,{"label-position":h.value,"label-width":"100px",rules:$,model:t,style:{"max-width":"460px"},ref_key:"ruleFormRef",ref:a},{default:u(()=>[r(n,{label:o.$t("newpassword"),prop:"newpassword"},{default:u(()=>[r(l,{modelValue:t.newpassword,"onUpdate:modelValue":e[3]||(e[3]=s=>t.newpassword=s),modelModifiers:{trim:!0},maxlength:"20",autocomplete:"off",placeholder:"new password",onKeydown:e[4]||(e[4]=_(s=>g(a.value),["enter"]))},null,8,["modelValue"])]),_:1},8,["label"]),r(n,{label:o.$t("verification"),prop:"check"},{default:u(()=>[r(l,{modelValue:t.check,"onUpdate:modelValue":e[5]||(e[5]=s=>t.check=s),modelModifiers:{trim:!0},placeholder:"verification code",maxlength:"10",onKeydown:e[6]||(e[6]=_(s=>g(a.value),["enter"]))},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["label-position","rules","model"]),d("div",{class:R(["submit",{shake:I(b).getDisabled}])},[d("button",{onClick:e[7]||(e[7]=s=>g(a.value)),style:{float:"left"}},m(o.$t("reguser")),1),r(x,{type:"success",href:"/login"},{default:u(()=>[D(m(o.$t("regusermessage")),1)]),_:1})],2)])])}}});const se=K(H,[["__scopeId","data-v-3451c7ea"]]);export{se as default};
